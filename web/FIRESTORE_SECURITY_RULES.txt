===========================================
FIRESTORE SECURITY RULES - Multi-Location Permission System
===========================================

Copy and paste these rules into your Firebase Console:
Firestore Database → Rules

-------------------------------------------

rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    
    // Users collection - authenticated users can read/write
    // Permission checks happen in the application layer
    match /users/{userId} {
      allow read: if request.auth != null;
      allow create: if request.auth != null && request.auth.uid == userId;
      allow update: if request.auth != null;
    }
    
    // Invites collection - authenticated users can read/write
    match /invites/{inviteId} {
      allow read, write: if request.auth != null;
    }
    
    // Locations collection - authenticated users can read/write
    match /locations/{locationId} {
      allow read, write: if request.auth != null;
    }
    
    // Businesses collection
    match /businesses/{businessId} {
      allow read, write: if request.auth != null;
    }
    
    // Contacts collection
    match /contacts/{contactId} {
      allow read, write: if request.auth != null;
    }
    
    // Location-specific contact relationships
    match /locationContacts/{locationContactId} {
      allow read, write: if request.auth != null;
    }
  }
}

-------------------------------------------
SETUP INSTRUCTIONS:
-------------------------------------------

1. Go to Firebase Console → Firestore Database → Rules
2. Replace the existing rules with the rules above
3. Click "Publish"

IMPORTANT NOTES:
- These simplified rules allow any authenticated user to read/write
- Permission checks (admin, view, edit) happen in the APPLICATION layer
- This is simpler and avoids Firestore's limitations with complex list queries
- For production, you may want stricter rules based on your security needs

FIRST USER SETUP (make yourself an admin):
1. Go to Firestore Database → users collection
2. Find your user document (by your UID)
3. Add/edit field: isGlobalAdmin = true
4. Add/edit field: locationPermissions = [] (empty array)

The application will handle permission checks:
- Only admins see the Admin Panel and Locations pages
- Users without any permissions see the "No Access" page
- Location-specific view/edit permissions are enforced in the UI
